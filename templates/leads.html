{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}

<br><h1 style="text-align:center">Lead Store</h1><br>

<!-- filter table dropdown  DYLAN ADDED-->
<form class="form-inline" method="POST" action="{{ url_for('updated_filter') }}">

    <div class="form-group">
        <label for="exampleFormControlInput1">Filter by </label>
        <div class="input-group">
                <select name="comp_select" class="selectpicker form-control">
                    <option>last_name</option>
                    <option>city</option>
                    <option>zip_code</option>
                    <option>owner_occupied</option>
                    <option>property_type</option>
                    <option>mls_status</option>
                </select>
        </div>
        <div class="form-group">
            <label for="exampleFormControlInput1">Enter Filter Query</label>
            <input name="info" class="form-control" id="exampleFormControlInput1" placeholder="name/city/zip">
        </div>
        <button type="submit" class="btn btn-primary">Go</button>
    </div>
</form>


    
<span style="float: right;"><input type="checkbox"  id='updateme' onClick="toggle(this)"/>Update All</span><br/>

<div class="table-responsive">
    <form action="" method='POST'>
        <table class="table table-bordered" style="border-radius: 4px; overflow: hidden;">
            <tr>
                <!-- <th>ID</th> -->
                <th>First Name</th>
                <th>Last Name</th>
                <th>Age</th>
                <th>Address</th>
                <th>City</th>
                <th>State</th>
                <th>Zip Code</th>
                <th>Owner Occupied</th>
                <th>Property Type</th>
                <th>MLS Status</th>
                <th>Phone Number</th>
                <th>Email</th>
                <th>Contacted?</th>
                <th>Time of Contact</th>
                <th>Sent Template</th>
                <th>Response</th>
                <th>Motivation Level</th>
                <th>Select</th>
            </tr>
            {%  for lead in leads.items %}
            <tr>
                <!-- <td>{{lead.id}}</td> -->
                <td>{{lead.first_name}}</td>
                <td>{{lead.last_name}}</td>
                <td>{{lead.age}}</td>
                <td>{{lead.address}}</td>
                <td>{{lead.city}}</td>
                <td>{{lead.state}}</td>
                <td>{{lead.zip_code}}</td>
                <td>{{lead.owner_occupied}}</td>
                <td>{{lead.property_type}}</td>
                <td>{{lead.mls_status}}</td>
                <td>{{lead.phone_number}}</td>
                <td>{{lead.email}}</td>
                <td>{{lead.contacted}}</td>
                <td>{{lead.contact_time}}</td>
                <td>{{lead.template_sent}}</td>
                <td>{{lead.response}}</td>
                <td>{{lead.motivation_level}}</td>
                <td><input type="checkbox" id="select" name="select" value={{lead.id}}>{{lead.id}}</td>
            </tr>
            {% endfor %}
        </table>
        <button type='submit'>get phone numbers and emails</button>
    </form>
</div>

<!-- Pagination Links-->
<div class="text-right">
    <a href="{{ url_for('leads', page=leads.prev_num) }}"
       class="btn btn-outline-dark 
       {% if leads.page == 1 %}disabled{% endif %}">
        &laquo;
    </a>
<!-- Loop through the number of pages to display a link for each-->
    {% for page_num in leads.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
{% if page_num %}
<!-- Check for the active page and set the link to "Active"-->
            {% if leads.page == page_num %}
            <a href="{{ url_for('leads', page=page_num) }}"
               class="btn btn-dark">
                {{ page_num }}
            </a>
            {% else %}
            <a href="{{ url_for('leads', page=page_num) }}"
               class="btn btn-outline-dark">
                {{ page_num }}
            </a>
            {% endif %}
        {% else %}
            ...
        {% endif %}
    {% endfor %}
    <a href="{{ url_for('leads', page=leads.next_num) }}"
       class="btn btn-outline-dark 
       {% if leads.page == leads.pages %}disabled{% endif %}">
        &raquo;
    </a>
</div>
<p class="text-right mt-3">
   Showing page {{ leads.page }} of {{ leads.pages }}
</p>

<script >
    document.getElementById('updateme').onclick = function() {
        var checkboxes = document.getElementsByName('select');
        for (var checkbox of checkboxes) {
            checkbox.checked = this.checked;
        }
    }
</script>
{% endblock %}

